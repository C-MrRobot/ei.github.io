<!DOCTYPE html>
<html>
    <!-- Head -->
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="author" content="MrRobot.C">
    <meta name="description" itemprop="description" content="">
    <meta name="keywords" content="">

    <!-- Page Title -->
    
        <title>Hive从入门到精通 | Bigdata大数据</title>
    
    <link rel="icon" href="/img/avatar-default.png">
    <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
    <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    
    
<script src="/ei.github.io/js/script.js"></script>

    
<link rel="stylesheet" href="/ei.github.io/css/style.css">

    
    <style>
        .deactiveColor{
            color: #37474f;
        }
        .activeColor{
            color: #006064;
        }
        a:hover{
            color: #006064;
        }
        .header-btn{
            color: #37474f;
        }
        
        .post-content img{
            margin: 50px auto;
        }
        
    </style>
<meta name="generator" content="Hexo 5.4.0"></head>
    <body>
        <div class="container">

            <!-- Top Anchor -->
            <div id="top"></div>

            <!-- Header -->
            <header class="header-wrapper">
    <div class="header-title-wrapper">
        <!-- Page Title -->
        <p class="header-title">
             
                
                    Hive从入门到精通
                
            
        </p>  
    </div>    

    
        <!-- Division Line -->
        <div class="division"></div> 
    
    
    <div class="header-detail">
        <!-- Header Button -->
        <div class="header-btn-wrapper">
            
                <span>
                    <a class="home-btn header-btn" href="/ei.github.io/" title="homepage"><i class="fa fa-home"></i></a>
                </span>

                
                    <span>
                        <a class="catalog-btn header-btn"><i class="fa fa-list-ul"></i></a>
                    </span>
                
            
        </div>
    </div>
</header>

            <!-- Main -->
            <main>
                <article class="post-wrapper">
    

    
        <!-- Article Catalog -->
        <div class="catalog-dropdown col-xs-12 col-sm-12">
            
        </div>
    

    
        <!--For now, Lightbox Only Show in Post Layout -->
        

        
        
    

    

    <!-- Article Content -->
    <div class="post-content">
        <p>###Hive常用操作###<br>beeline客户端命令：<br>beeline –hiveconf  hive.server2.logging.operation.level=NONE<br>beeline -f “test.sql”<br>beeline -e  show databases<br>beeline -n  username -p password -u jdbc:hive2://hs2.local:10012<br>beeline -u  jdbc:hive2://192.168.0.76:10000 -n postgres<br>beeline –hiveconf  ‘hive.server2.tez.initialize.default.sessions=true’  ‘hive.cli.print.header=false’   -e   ‘sql’<br>describe formated  table_name;<br>show create database $dbname;<br>show create table $tablename;<br>drop  database  myhive  cascade; （删库删表，慎用）<br>TRUNCATE TABLE  Tablename; 删表数据<br>describe database bigdata;<br>###Hive常用语法###<br>修改执行引擎: <br>       set hive.execution.engine=spark;<br>修改hive 提交队列：     <br>       set mapreduce.job.queuename=default<br>修改hive表的ower：<br>       ALTER TABLE $table_name SET OWNER user $username;<br>修改表的序列化：<br>       ALTER TABLE  $tablename set SERDE “org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe”;  (RCFlie)<br>修改表存储格式：<br>       ALTER TABLE $tablename SET FILEFORMAT<br>       INPUTFORMAT “org.apache.hadoop.hive.ql.io.RCFileInputFormat”<br>       OUTPUTFORMAT “org.apache.hadoop.hive.ql.io.RCFileOutputFormat”;<br>修改存储路径：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/weijiqian/p/14335772.html">https://www.cnblogs.com/weijiqian/p/14335772.html</a> <br>       ALTER TABLE $table_name  set location ‘/hive/warehouse/test.db/tb_table2<br>‘;</p>
<p>###Hive metastore元数据操作###<br>find / -name gsql<br>./gsql -p 20051  -d hivemeta -U omm -W dbserverAdmin@123 <br>     查询表结构： select pg_get_tabledef(‘public.HUE_PERMISSION_id_SEQ’)<br>hive默认元数据为DBserver服务。<br>omm 管理员密码：dbserverAdmin@123<br>hive 密码：HiveUser@<br>如果被锁需解锁，语句：ALTER USER hive ACCOUNT UNLOCK</p>
<p>###Hive调优###<br>性能优化：<a target="_blank" rel="noopener" href="https://support.huaweicloud.com/cmpntguide-mrs/mrs_01_0979.html">https://support.huaweicloud.com/cmpntguide-mrs/mrs_01_0979.html</a><br>     SET spark.sql.hive.convertMetastoreParquet = false;<br>     spark自带的序列化方式无法解析hive中的parquet数据，便读不到数据，此时可以将这个参数设置为false。</p>
<p>A:  yarn<br>    yarn.nodemanager.resource.cpu-vcores 调整每个nodemanager占用core节点的cpu核数<br>    yarn.nodemanager.resource.memory-mb 调整每个nodemanager占用core节点的memory数<br>    yarn.scheduler.minimum-allocation-mb 每个contain最小申请的内存<br>    yarn.scheduler.maximum-allocation-mb 每个contain最大申请的内存<br>    yarn.scheduler.minimum-allocation-vcores 每个contain最小申请的核数<br>    yarn.scheduler.maximum-allocation-vcores 每个contain最大申请的核数<br>    mapreduce.map.memory.mb： 每个map任务内存量<br>    mapreduce.map.cpu.vcores 每个map任务cpu数量</p>
<p>B:  MR<br>    set mapred.min.split.size=1; <br>    set mapred.max.split.size=128000000; 增大map task的数量 <br>    set mapred.map.tasks=2； 增大map task的数量 ，无用！！<br>    set mapred.reduce.tasks=1000; 增大reduce task的数量<br>    mapreduce.map.memory.mb 每个Map task设置map的最大内存<br>    mapreduce.reduce.memory.mb 每个Reduce task设置reduce的最大内存</p>
<p>C: TEZ<br>   1.set hive.tez.cpu.vcores=3 设置每个task的cpu使用<br>   2.如果tez是contain模式，尽量调节contain的数量，因为contain多了，那么里面运行的task也多了，并行度就上来了</p>
<p>###Hive实战###<br>create table bigdata.eimrs(id string,name string,worker string,happies string,age int);<br>insert into table bigdata.eimrs values(“0”,”张三”,”程序员”,”踢足球”,30);<br>insert into table bigdata.eimrs values(“1”,”李四”,”艺术家”,”打篮球”,28);<br>insert into table bigdata.eimrs  values(“2”,”王五”,”程序员”,”乒乓球”,32);<br>insert into table bigdata.eimrs  values(“3”,”成哥”,”程序员”,”铅球”,32);<br>2：创建外部表：<br>create external table student (s_id string,s_name string) row format delimited fields terminated by ‘\t’;<br>create external table bigdata.eimrs0(id string comment “id”,name string comment “名称”,teacher string comment “授课老师信息”)<br>comment “测试JSON格式外部表”<br>row format serde ‘org.apache.hive.hcatalog.data.JsonSerDe’<br>stored as textfile;<br>3：创建分区表：<br>create table score2 (s_id string, s_score int) partitioned by (year string,month string,day string);<br>insert into table score2 partition(year=’2021’,month=’01’,day=’01’) values(“1”,20);:<br>4：创建表指定obs 路径：<br>create database if not exists $database_name  location  “obs://桶/目录/“;<br>create table test(name string) location “obs://桶/user/hive/warehouse/test”;<br>5：load本地数据：<br>追加操作<br>load data local inpath ‘/export/servers/hivedatas/student.csv’ into table student;<br>覆盖操作：<br>load data local inpath ‘/export/servers/hivedatas/student.csv’ overwrite  into table student;<br>6：loadHDFS数据：<br>load data inpath ‘/hivedatas/techer.csv’ into table techer;<br>load data inpath ‘/hivedatas/techer.csv’ into table techer partition(cur_date=20201210);  （load到指定分区）<br>7：修改hive表的ower：<br>ALTER TABLE $table_name SET OWNER user $username;<br>8：修改存储路径：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/weijiqian/p/14335772.html">https://www.cnblogs.com/weijiqian/p/14335772.html</a> <br>ALTER TABLE $table_name SET location ‘/hive/warehouse/test.db/tb_table2’;！</p>
  
    </div> 

    
        <!-- Division Line -->
        <div class="division"></div> 
    

    <div class="post-info-wrapper">
            
                    <!-- Post Info -->
                    <p class="post-date">2021-11-17</p>
                    
                    
                        <p class="post-info-categories">
                            
                        </p>
                    

                    
            
    </div>
</article>


    

            </main>

            <!-- 'To Top' Btn-->
            
                <div id="to-top">
    <a href="#top" class="toTop">
        <i class="fa fa-pagelines"></i>
    </a>
</div>
            

            <!-- Footer -->
            
                <footer class="footer-wrapper col-xs-12 col-sm-12">
    <div class="footer-banner-wrapper">
        <p class="footer-banner">Powered by <a target="_blank" rel="noopener" href="https://hexo.io/" title="Hexo">Hexo</a></p>
        <P class="footer-banner">Theme <a target="_blank" rel="noopener" href="https://github.com/Lonezj/hexo-theme-wind" title="Wind">wind</a></P>
    </div>
</footer>
            
        </div>

        <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css">
        <link rel="stylesheet" href="/css/google-prettify-monokai.css" type="text/css">
        <script src="//cdn.bootcss.com/prettify/r298/prettify.min.js" type="text/javascript"></script>
    </body>
</html>